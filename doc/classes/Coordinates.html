<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Coordinates</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Coordinates</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/home/matt/src/ruby/coord/coord_rb.html">
                /home/matt/src/ruby/coord/coord.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">
    <div id="diagram">
      <map id="map" name="map">
  <area shape="RECT" coords="40,125,120,173"      href="Coordinate.html" alt="Coordinate">
  <area shape="RECT" coords="144,125,237,173"      href="ProjectionInfo.html" alt="ProjectionInfo">
  <area shape="RECT" coords="261,125,333,173"      href="GridInfo.html" alt="GridInfo">
  <area shape="RECT" coords="261,29,333,77"      href="Info.html" alt="Info">
  <area shape="RECT" coords="357,125,442,173"      href="EllipsoidInfo.html" alt="EllipsoidInfo">
  <area shape="RECT" coords="357,29,429,77"      href="Numeric.html" alt="Numeric">
  <area shape="RECT" coords="453,29,538,77"      href="Coordinates.html" alt="Coordinates">
  <area shape="RECT" coords="18,18,141,65"      href="CoordinateConversion.html" alt="CoordinateConversion">
</map>
<img src="../dot/f_0.png" usemap="#map" border=0 alt="TopLevel">
    </div>

    <div id="description">
      <p>
Transforms sets of coordinates: Currently supports:
</p>
<ul>
<li>lat + long (+ ellipsoid height)

</li>
<li>3D cartesian (x, y, z)

</li>
<li>Transverse Mercator (easting, northing)

</li>
</ul>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000031">cart_to_llh</a>&nbsp;&nbsp;
      <a href="#M000029">en_to_ll</a>&nbsp;&nbsp;
      <a href="#M000030">en_to_ng</a>&nbsp;&nbsp;
      <a href="#M000028">ll_to_en</a>&nbsp;&nbsp;
      <a href="#M000032">llh_to_cart</a>&nbsp;&nbsp;
      <a href="#M000027">new</a>&nbsp;&nbsp;
      <a href="#M000033">ng_to_en</a>&nbsp;&nbsp;
      <a href="#M000034">ng_to_ll</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(debug = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 106</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">debug</span> = <span class="ruby-keyword kw">false</span>)
    <span class="ruby-ivar">@debug</span> = <span class="ruby-identifier">debug</span>
    
    <span class="ruby-comment cmt"># Generate a load of trig functions: just sugar for the mass of</span>
    <span class="ruby-comment cmt"># calculations in ll_to_utm.</span>
    [<span class="ruby-value str">'sin'</span>, <span class="ruby-value str">'cos'</span>, <span class="ruby-value str">'tan'</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">op</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">eval</span> <span class="ruby-node">&quot;def #{op}(v); Math.#{op}(v); end&quot;</span>
      (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">8</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">eval</span> <span class="ruby-node">&quot;def #{op}#{x}(v); (Math.#{op}(v))**#{x}; end&quot;</span>
      }
    }
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">cart_to_llh</span><span class="method-args">(x, y, z, ell_type = 'Airy 1830', prec = 10e-9)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iteratively convert from cartesian to lat, long and height.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 255</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cart_to_llh</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">z</span>, <span class="ruby-identifier">ell_type</span> = <span class="ruby-value str">'Airy 1830'</span>, <span class="ruby-identifier">prec</span> = <span class="ruby-value">10e-9</span>)
    <span class="ruby-identifier">ell</span>      = <span class="ruby-constant">EllipsoidInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ell_type</span>)
    <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">e_2</span>= <span class="ruby-identifier">ell</span>.<span class="ruby-identifier">returnInfo</span>

    <span class="ruby-comment cmt"># TODO: check quadrant?</span>
    <span class="ruby-identifier">lam</span>      = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">atan</span>(<span class="ruby-identifier">y</span>.<span class="ruby-identifier">to_f</span><span class="ruby-operator">/</span><span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>)

    <span class="ruby-identifier">p</span>        = (<span class="ruby-identifier">x</span><span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>)<span class="ruby-operator">**</span><span class="ruby-value">0</span><span class="ruby-value">.5</span>
    <span class="ruby-identifier">phi_a</span>    = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">atan</span>(<span class="ruby-identifier">z</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">p</span> <span class="ruby-operator">*</span> (<span class="ruby-value">1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">e_2</span>)))
    <span class="ruby-identifier">phi_b</span>    = <span class="ruby-value">0</span>

    <span class="ruby-comment cmt"># Iteratively compute phi.</span>
    <span class="ruby-keyword kw">while</span> ((<span class="ruby-identifier">phi_a</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">phi_b</span>).<span class="ruby-identifier">abs</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">prec</span>)
      <span class="ruby-identifier">v</span>     = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> ((<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi_a</span>))<span class="ruby-operator">**</span><span class="ruby-value">-0</span><span class="ruby-value">.5</span>)
      <span class="ruby-identifier">tmp</span>   = <span class="ruby-identifier">phi_a</span>
      <span class="ruby-identifier">phi_a</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">atan</span>((<span class="ruby-identifier">z</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e_2</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">*</span><span class="ruby-identifier">sin</span>(<span class="ruby-identifier">phi_a</span>)) <span class="ruby-operator">/</span> <span class="ruby-identifier">p</span>)
      <span class="ruby-identifier">phi_b</span> = <span class="ruby-identifier">tmp</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-comment cmt"># Compute the height.</span>
    <span class="ruby-identifier">h</span> = <span class="ruby-identifier">p</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi_a</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">v</span>

    [<span class="ruby-identifier">phi_a</span>, <span class="ruby-identifier">lam</span>, <span class="ruby-identifier">h</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">en_to_ll</span><span class="method-args">(ee, nn, proj_type = 'National Grid')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Convert easting (<tt>ee</tt>) and northing (<tt>nn</tt>) to lat and long.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 171</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">en_to_ll</span>(<span class="ruby-identifier">ee</span>, <span class="ruby-identifier">nn</span>, <span class="ruby-identifier">proj_type</span> = <span class="ruby-value str">'National Grid'</span>)

    <span class="ruby-identifier">proj</span>    = <span class="ruby-constant">ProjectionInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">proj_type</span>)
    <span class="ruby-identifier">phi_0</span>, <span class="ruby-identifier">lam_0</span>, <span class="ruby-identifier">n_0</span>, <span class="ruby-identifier">e_0</span>, <span class="ruby-identifier">f_0</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">e_2</span> = <span class="ruby-identifier">proj</span>.<span class="ruby-identifier">returnInfo</span>

    <span class="ruby-identifier">n</span> = (<span class="ruby-identifier">a</span><span class="ruby-operator">-</span><span class="ruby-identifier">b</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">a</span><span class="ruby-operator">+</span><span class="ruby-identifier">b</span>)
    <span class="ruby-identifier">phi_pr</span>  = (<span class="ruby-identifier">nn</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">n_0</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">phi_0</span>
    
    <span class="ruby-comment cmt"># A few useful differences.</span>
    <span class="ruby-identifier">phi_d</span>   = <span class="ruby-identifier">phi_pr</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">phi_0</span>
    <span class="ruby-identifier">phi_p</span>   = <span class="ruby-identifier">phi_pr</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">phi_0</span>
    
    <span class="ruby-identifier">m</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">eval</span>(<span class="ruby-ivar">@@m_eqn</span>)
    <span class="ruby-identifier">comp</span> = <span class="ruby-identifier">nn</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">n_0</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">m</span>
     
    <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">comp</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span><span class="ruby-value">.01e-3</span>
      <span class="ruby-identifier">phi_pr</span> = <span class="ruby-identifier">comp</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">phi_pr</span>
      <span class="ruby-identifier">phi_d</span> = <span class="ruby-identifier">phi_pr</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">phi_0</span>
      <span class="ruby-identifier">phi_p</span> = <span class="ruby-identifier">phi_pr</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">phi_0</span>
      <span class="ruby-identifier">m</span> = <span class="ruby-value str">''</span>
      <span class="ruby-identifier">eval</span>(<span class="ruby-ivar">@@m_eqn</span>)
      <span class="ruby-identifier">comp</span>  = <span class="ruby-identifier">nn</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">n_0</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">m</span>
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-identifier">v</span>       = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span> <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi_pr</span>))<span class="ruby-operator">**</span><span class="ruby-value">-0</span><span class="ruby-value">.5</span>
    <span class="ruby-identifier">rho</span>         = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span> <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span>) <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span><span class="ruby-operator">*</span><span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi_pr</span>))<span class="ruby-operator">**</span><span class="ruby-value">-1.5</span>
    <span class="ruby-identifier">eta_2</span>   = (<span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">rho</span>) <span class="ruby-operator">-</span> <span class="ruby-value">1</span>

    <span class="ruby-identifier">vii</span>     = <span class="ruby-identifier">tan</span>(<span class="ruby-identifier">phi_pr</span>) <span class="ruby-operator">/</span> (<span class="ruby-value">2</span><span class="ruby-operator">*</span><span class="ruby-identifier">rho</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span>)
    <span class="ruby-identifier">viiia</span>   = <span class="ruby-identifier">tan</span>(<span class="ruby-identifier">phi_pr</span>) <span class="ruby-operator">/</span> (<span class="ruby-value">24</span><span class="ruby-operator">*</span><span class="ruby-identifier">rho</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">**</span><span class="ruby-value">3</span>)
    <span class="ruby-identifier">viiib</span>   = <span class="ruby-value">5</span><span class="ruby-operator">+</span><span class="ruby-value">3</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">eta_2</span> <span class="ruby-operator">-</span> <span class="ruby-value">9</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>))<span class="ruby-operator">*</span><span class="ruby-identifier">eta_2</span>
    <span class="ruby-identifier">viii</span>    = <span class="ruby-identifier">viiia</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">viiib</span>

    <span class="ruby-identifier">ixa</span>     = <span class="ruby-identifier">tan</span>(<span class="ruby-identifier">phi_pr</span>) <span class="ruby-operator">/</span> (<span class="ruby-value">720</span><span class="ruby-operator">*</span><span class="ruby-identifier">rho</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">**</span><span class="ruby-value">5</span>) 
    <span class="ruby-identifier">ixb</span>     = <span class="ruby-value">61</span> <span class="ruby-operator">+</span> <span class="ruby-value">90</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>) <span class="ruby-operator">+</span> <span class="ruby-value">45</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan4</span>(<span class="ruby-identifier">phi_pr</span>)
    <span class="ruby-identifier">ix</span>      = <span class="ruby-identifier">ixa</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">ixb</span>

    <span class="ruby-identifier">x</span>       = <span class="ruby-value">1</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">*</span><span class="ruby-identifier">v</span>)

    <span class="ruby-identifier">xia</span>     = <span class="ruby-value">1</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">*</span><span class="ruby-value">6</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">**</span><span class="ruby-value">3</span>)
    <span class="ruby-identifier">xib</span>     = <span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">rho</span> <span class="ruby-operator">+</span> <span class="ruby-value">2</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>)
    <span class="ruby-identifier">xi</span>      = <span class="ruby-identifier">xia</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">xib</span>

    <span class="ruby-identifier">xiia</span>    = <span class="ruby-value">1</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">*</span><span class="ruby-value">120</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">**</span><span class="ruby-value">5</span>)
    <span class="ruby-identifier">xiib</span>    = <span class="ruby-value">5</span> <span class="ruby-operator">+</span> <span class="ruby-value">28</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">+</span><span class="ruby-value">24</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan4</span>(<span class="ruby-identifier">phi_pr</span>)
    <span class="ruby-identifier">xii</span>     = <span class="ruby-identifier">xiia</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">xiib</span>

    <span class="ruby-identifier">xiiia</span>   = <span class="ruby-value">1</span> <span class="ruby-operator">/</span> (<span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">*</span><span class="ruby-value">5040</span><span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">**</span><span class="ruby-value">7</span>)
    <span class="ruby-identifier">xiiib</span>   = <span class="ruby-value">61</span> <span class="ruby-operator">+</span> <span class="ruby-value">662</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">+</span><span class="ruby-value">1320</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan4</span>(<span class="ruby-identifier">phi_pr</span>)<span class="ruby-operator">+</span><span class="ruby-value">720</span><span class="ruby-operator">*</span><span class="ruby-identifier">tan6</span>(<span class="ruby-identifier">phi_pr</span>)
    <span class="ruby-identifier">xiii</span>    = <span class="ruby-identifier">xiiia</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">xiiib</span>

    <span class="ruby-comment cmt"># Fancy debug printing.</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>
      [<span class="ruby-identifier">:v</span>, <span class="ruby-identifier">:rho</span>, <span class="ruby-identifier">:eta_2</span>, <span class="ruby-identifier">:vii</span>, <span class="ruby-identifier">:viii</span>, <span class="ruby-identifier">:ix</span>, <span class="ruby-identifier">:x</span>, <span class="ruby-identifier">:xi</span>, <span class="ruby-identifier">:xii</span>, <span class="ruby-identifier">:xiii</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">id2name</span>
        <span class="ruby-identifier">val</span> =  <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">n</span>.<span class="ruby-identifier">id2name</span>)
        <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;%s\t%10.10e\n&quot;</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">val</span>
      }
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-identifier">phi</span>     = <span class="ruby-identifier">phi_pr</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">vii</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">viii</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">4</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">ix</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">6</span>
    <span class="ruby-identifier">lam</span>     = <span class="ruby-identifier">lam_0</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">xi</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">3</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xii</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">5</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">xiii</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">ee</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_0</span>)<span class="ruby-operator">**</span><span class="ruby-value">7</span>
    [<span class="ruby-identifier">phi</span>, <span class="ruby-identifier">lam</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">en_to_ng</span><span class="method-args">(e, n, grid_type = 'GB')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Convert easting and northing to national grid.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 238</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">en_to_ng</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">n</span>, <span class="ruby-identifier">grid_type</span> = <span class="ruby-value str">'GB'</span>)

    <span class="ruby-identifier">g</span> = <span class="ruby-constant">GridInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">grid_type</span>)
    <span class="ruby-identifier">grid</span> = <span class="ruby-identifier">g</span>.<span class="ruby-identifier">returnInfo</span>
    
    <span class="ruby-identifier">x</span> = (<span class="ruby-identifier">e</span> <span class="ruby-operator">/</span> <span class="ruby-value">100000</span>).<span class="ruby-identifier">floor</span>
    <span class="ruby-identifier">y</span> = (<span class="ruby-identifier">n</span> <span class="ruby-operator">/</span> <span class="ruby-value">100000</span>).<span class="ruby-identifier">floor</span>

    <span class="ruby-identifier">new_easting</span> = (<span class="ruby-identifier">e</span><span class="ruby-operator">-</span><span class="ruby-identifier">x</span><span class="ruby-operator">*</span><span class="ruby-value">100000</span>).<span class="ruby-identifier">round</span>
    <span class="ruby-identifier">new_northing</span> = (<span class="ruby-identifier">n</span><span class="ruby-operator">-</span><span class="ruby-identifier">y</span><span class="ruby-operator">*</span><span class="ruby-value">100000</span>).<span class="ruby-identifier">round</span>

    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{grid[y][x]} #{new_easting} #{new_northing}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>

    [<span class="ruby-identifier">grid</span>[<span class="ruby-identifier">y</span>][<span class="ruby-identifier">x</span>], <span class="ruby-identifier">new_easting</span>, <span class="ruby-identifier">new_northing</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="#M000028" class="method-signature">
          <span class="method-name">ll_to_en</span><span class="method-args">(phi, lam, proj_type = 'National Grid')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Convert from lat (<tt>phi</tt> (rads)) and long (<tt>lam</tt> (rads)) to
easting and northing
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 121</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ll_to_en</span>(<span class="ruby-identifier">phi</span>, <span class="ruby-identifier">lam</span>, <span class="ruby-identifier">proj_type</span> = <span class="ruby-value str">'National Grid'</span>)
   
    <span class="ruby-identifier">proj</span> = <span class="ruby-constant">ProjectionInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">proj_type</span>)
    <span class="ruby-identifier">phi_0</span>, <span class="ruby-identifier">lam_0</span>, <span class="ruby-identifier">n_0</span>, <span class="ruby-identifier">e_0</span>, <span class="ruby-identifier">f_0</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">e_2</span> = <span class="ruby-identifier">proj</span>.<span class="ruby-identifier">returnInfo</span>
    
    <span class="ruby-comment cmt"># A few useful differences.</span>
    <span class="ruby-identifier">phi_d</span>   = <span class="ruby-identifier">phi</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">phi_0</span>
    <span class="ruby-identifier">phi_p</span>   = <span class="ruby-identifier">phi</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">phi_0</span>
    <span class="ruby-identifier">lam_d</span>   = <span class="ruby-identifier">lam</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lam_0</span>
    <span class="ruby-identifier">lam_p</span>   = <span class="ruby-identifier">lam</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">lam_0</span>

    <span class="ruby-identifier">n</span>           = (<span class="ruby-identifier">a</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">b</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">a</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">b</span>)

    <span class="ruby-identifier">v</span>           = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span> <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi</span>))<span class="ruby-operator">**</span><span class="ruby-value">-0</span><span class="ruby-value">.5</span>
    <span class="ruby-identifier">rho</span>         = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">f_0</span> <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span>) <span class="ruby-operator">*</span> (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span><span class="ruby-operator">*</span><span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi</span>))<span class="ruby-operator">**</span><span class="ruby-value">-1.5</span>

    <span class="ruby-identifier">eta_2</span>   = (<span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">rho</span>) <span class="ruby-operator">-</span> <span class="ruby-value">1</span>

    <span class="ruby-identifier">m</span> = <span class="ruby-value str">''</span>
    <span class="ruby-identifier">eval</span>(<span class="ruby-ivar">@@m_eqn</span>)

    <span class="ruby-identifier">i</span>               = <span class="ruby-identifier">m</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">n_0</span>
    <span class="ruby-identifier">ii</span>          = (<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-value">2.0</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">sin</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi</span>)
    <span class="ruby-identifier">iii</span>         = (<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-value">24.0</span>)<span class="ruby-operator">*</span> <span class="ruby-identifier">sin</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos3</span>(<span class="ruby-identifier">phi</span>)
    <span class="ruby-identifier">iii</span>     <span class="ruby-operator">*=</span> (<span class="ruby-value">5</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">+</span> <span class="ruby-value">9</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">eta_2</span>)
    <span class="ruby-identifier">iiia</span>        = (<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-value">720.0</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">sin</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos5</span>(<span class="ruby-identifier">phi</span>)
    <span class="ruby-identifier">iiia</span>    <span class="ruby-operator">*=</span> <span class="ruby-value">61</span> <span class="ruby-operator">-</span> <span class="ruby-value">58</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">tan4</span>(<span class="ruby-identifier">phi</span>)
    <span class="ruby-identifier">iv</span>          = <span class="ruby-identifier">v</span><span class="ruby-operator">*</span> <span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi</span>)
    <span class="ruby-identifier">vv</span>          = (<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-value">6.0</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos3</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> ((<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-identifier">rho</span>)<span class="ruby-operator">-</span> <span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi</span>))

    <span class="ruby-identifier">va</span>          = (<span class="ruby-identifier">v</span><span class="ruby-operator">/</span><span class="ruby-value">120.0</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos5</span>(<span class="ruby-identifier">phi</span>) 
    <span class="ruby-identifier">vb</span>      = <span class="ruby-value">5</span> <span class="ruby-operator">-</span> <span class="ruby-value">18</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">tan4</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">+</span> <span class="ruby-value">14</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">eta_2</span>
    <span class="ruby-identifier">vb</span>      <span class="ruby-operator">-=</span> (<span class="ruby-value">58</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">tan2</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">eta_2</span>)
    <span class="ruby-identifier">vi</span>      = <span class="ruby-identifier">va</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">vb</span>

    <span class="ruby-identifier">n</span>           = <span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ii</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span><span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">iii</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span><span class="ruby-operator">**</span><span class="ruby-value">4</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">iiia</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span><span class="ruby-operator">**</span><span class="ruby-value">6</span>
    <span class="ruby-identifier">e</span>           = <span class="ruby-identifier">e_0</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">iv</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">vv</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span><span class="ruby-operator">**</span><span class="ruby-value">3</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">vi</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">lam_d</span><span class="ruby-operator">**</span><span class="ruby-value">5</span>

    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>
      [<span class="ruby-identifier">:v</span>, <span class="ruby-identifier">:rho</span>, <span class="ruby-identifier">:eta_2</span>, <span class="ruby-identifier">:m</span>, <span class="ruby-identifier">:i</span>, <span class="ruby-identifier">:ii</span>, <span class="ruby-identifier">:iii</span>, <span class="ruby-identifier">:iiia</span>, <span class="ruby-identifier">:iv</span>, <span class="ruby-identifier">:vv</span>, <span class="ruby-identifier">:e</span>, <span class="ruby-identifier">:n</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">id2name</span>
        <span class="ruby-identifier">val</span> =  <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">n</span>.<span class="ruby-identifier">id2name</span>)
        <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;%s\t%10.10e\n&quot;</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">val</span>
      }
    <span class="ruby-keyword kw">end</span>

    [<span class="ruby-identifier">e</span>, <span class="ruby-identifier">n</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">llh_to_cart</span><span class="method-args">(phi, lam, h, ell_type = 'Airy 1830')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Convert from lat, long and ellipsoid height to cartesian
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 280</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">llh_to_cart</span>(<span class="ruby-identifier">phi</span>, <span class="ruby-identifier">lam</span>, <span class="ruby-identifier">h</span>, <span class="ruby-identifier">ell_type</span> = <span class="ruby-value str">'Airy 1830'</span>)
    <span class="ruby-identifier">ell</span>      = <span class="ruby-constant">EllipsoidInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ell_type</span>)
    <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">e_2</span>= <span class="ruby-identifier">ell</span>.<span class="ruby-identifier">returnInfo</span>

    <span class="ruby-identifier">v</span>        = <span class="ruby-identifier">a</span> <span class="ruby-operator">*</span> ((<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">sin2</span>(<span class="ruby-identifier">phi</span>))<span class="ruby-operator">**</span><span class="ruby-value">-0</span><span class="ruby-value">.5</span>)
    <span class="ruby-identifier">x</span>        = (<span class="ruby-identifier">v</span><span class="ruby-operator">+</span><span class="ruby-identifier">h</span>)<span class="ruby-operator">*</span><span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">cos</span>(<span class="ruby-identifier">lam</span>)
    <span class="ruby-identifier">y</span>        = (<span class="ruby-identifier">v</span><span class="ruby-operator">+</span><span class="ruby-identifier">h</span>)<span class="ruby-operator">*</span><span class="ruby-identifier">cos</span>(<span class="ruby-identifier">phi</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">sin</span>(<span class="ruby-identifier">lam</span>)
    <span class="ruby-identifier">z</span>        = ((<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">e_2</span>)<span class="ruby-operator">*</span><span class="ruby-identifier">v</span><span class="ruby-operator">+</span><span class="ruby-identifier">h</span>)  <span class="ruby-operator">*</span> <span class="ruby-identifier">sin</span>(<span class="ruby-identifier">phi</span>)

    [<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">z</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="#M000033" class="method-signature">
          <span class="method-name">ng_to_en</span><span class="method-args">(prefix, e, n, grid_type = 'GB')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Convert from National Grid, back to plain old TM.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 309</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ng_to_en</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">n</span>, <span class="ruby-identifier">grid_type</span> = <span class="ruby-value str">'GB'</span>)
    <span class="ruby-comment cmt"># E and N multipliers.</span>
    <span class="ruby-identifier">me</span> = <span class="ruby-value">0</span>;
    <span class="ruby-identifier">mn</span> = <span class="ruby-value">0</span>;

    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
      <span class="ruby-identifier">e</span> = <span class="ruby-identifier">fix_ng_input</span>(<span class="ruby-identifier">e</span>)
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
      <span class="ruby-identifier">n</span> = <span class="ruby-identifier">fix_ng_input</span>(<span class="ruby-identifier">n</span>)
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-identifier">g</span> = <span class="ruby-constant">GridInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">grid_type</span>)
    <span class="ruby-identifier">grid</span> = <span class="ruby-identifier">g</span>.<span class="ruby-identifier">returnInfo</span>

    <span class="ruby-comment cmt"># Search the grid for the prefix location.</span>
    <span class="ruby-identifier">grid</span>.<span class="ruby-identifier">each_with_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">row</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">row</span>.<span class="ruby-identifier">each_with_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">entry</span>, <span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">prefix</span>
          <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Found #{entry} at #{i} #{j}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>
          <span class="ruby-identifier">mn</span> = <span class="ruby-identifier">i</span>
          <span class="ruby-identifier">me</span> = <span class="ruby-identifier">j</span>
          <span class="ruby-keyword kw">break</span>
        <span class="ruby-keyword kw">end</span>
      }
    }

    [<span class="ruby-identifier">e</span><span class="ruby-operator">+</span><span class="ruby-identifier">me</span><span class="ruby-operator">*</span><span class="ruby-value">100000</span>, <span class="ruby-identifier">n</span><span class="ruby-operator">+</span><span class="ruby-identifier">mn</span><span class="ruby-operator">*</span><span class="ruby-value">100000</span>]  
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="#M000034" class="method-signature">
          <span class="method-name">ng_to_ll</span><span class="method-args">(prefix, e, n, grid_type = 'GB', proj_type = 'National Grid')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
<span class="ruby-comment cmt"># File /home/matt/src/ruby/coord/coord.rb, line 339</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ng_to_ll</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">n</span>, <span class="ruby-identifier">grid_type</span> = <span class="ruby-value str">'GB'</span>, <span class="ruby-identifier">proj_type</span> = <span class="ruby-value str">'National Grid'</span>)
    <span class="ruby-identifier">en</span>, <span class="ruby-identifier">nn</span> =  <span class="ruby-identifier">ng_to_en</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">n</span>, <span class="ruby-identifier">grid_type</span>)
    <span class="ruby-comment cmt"># Now convert to lat and long (in radians).</span>
    <span class="ruby-identifier">phi</span>, <span class="ruby-identifier">lam</span> = <span class="ruby-identifier">en_to_ll</span>(<span class="ruby-identifier">en</span>, <span class="ruby-identifier">nn</span>, <span class="ruby-identifier">proj_type</span>)

    [<span class="ruby-identifier">phi</span>, <span class="ruby-identifier">lam</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>